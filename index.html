<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar.js">
        <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
        <script type="text/javascript" src="https://api.tianditu.gov.cn/api?v=4.0&tk=6bf911bc7f3938007bdb52450d5e4d15"></script>
    <style type="text/css">

        #mapDiv {
            width: 100%;
            height: 40%;
            position:absolute;
            bottom:0;
            left:0;
            z-index:9998;

        }
        #textIn{
            width: 100%;
            height: 10%;
            position:absolute;
            bottom:0;
            right:0;
            z-index:9998;
        }



  }
    </style>
    <script>
        var map;
        var zoom = 18;
        var icon = new T.Icon({
            iconUrl: "http://api.tianditu.gov.cn/img/map/markerA.png",
            iconSize: new T.Point(19, 27),
            iconAnchor: new T.Point(10, 25)
        });
        
        var PointMarker = new T.Marker(new T.LngLat(0.0, 0.0), {
            icon: icon
        });
        
        
        function onLoad() {
            map = new T.Map('mapDiv');
            map.centerAndZoom(new T.LngLat(120.120920, 30.265700), zoom);
            
            //将选点标记进行注册
            var opacity = 0;
            PointMarker.setOpacity(opacity);
            map.addOverLay(PointMarker);

            var cp = new T.CoordinatePickup(map, {
                callback: getLngLat
            })
            cp.addEvent();
            
            //将覆盖物的信息全部放在地图上表示
            var marker_1 = new T.Marker(new T.LngLat(120.120460,30.265340));
            map.addOverLay(marker_1);;

            var marker_1 = new T.Marker(new T.LngLat(120.120530,30.265320));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.120620,30.265300));
            map.addOverLay(marker_1);


            var marker_1 = new T.Marker(new T.LngLat(120.11946212500335, 30.267036580722934));
            map.addOverLay(marker_1);


            var marker_1 = new T.Marker(new T.LngLat(120.12023460119966, 30.266984689278928));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.1199932023883, 30.26698376258768));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.12069057673217, 30.267097738617565));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.12083005160095, 30.267435032619908));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.12083005160095, 30.267435032619908));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.12096952646972, 30.267767692327087));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.12077104300262, 30.267965990453526));
            map.addOverLay(marker_1);

            var marker_1 = new T.Marker(new T.LngLat(120.1204974576831, 30.268117030310187));
            map.addOverLay(marker_1);
        }
        
        function getLngLat(lnglat) {
            document.getElementById("lnglatStr").value = lnglat.lng.toFixed(6) + "," + lnglat.lat.toFixed(6);
            //创建标注对象
            //if (marker!=null)
            //map.removeOverLay(marker);
            // 如果不清除标注对象的话，则可以不断向图上添加点
            //map.clearOverLays();
            //var marker = new T.Marker(new T.LngLat(lnglat.lng.toFixed(6), lnglat.lat.toFixed(6)));
            //向地图上添加标注

            //map.addOverLay(marker);
            
            PointMarker.setLngLat(lnglat);
            PointMarker.setOpacity(1);
            map.addOverLay(PointMarker);

        }





    </script>
    </head>

    <body style="margin: 0; overflow: hidden;" onLoad ="onLoad()">

    <div id="mapDiv">

    </div>
    <div id="textIn">
        锚点坐标:
        <input type="text" id="lnglatStr" value="" />
    </div>


    <a-scene
            embeded arjs
            renderer="logarithmicDepthBuffer: true;"
            loading-screen="enabled: false;"
            arjs="sourceType: webcam; debugUIEnabled: true;"
        >
            <a-assets >
                <a-asset-item
                    id="animated-asset"
                    src="assets/asset.gltf"
                ></a-asset-item>
            </a-assets>

                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.265340; longitude: 120.120460;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.265320; longitude: 120.120530;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.265300; longitude: 120.120620;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.267036580722934; longitude: 120.11946212500335;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.266984689278928; longitude: 120.12023460119966;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.26698376258768; longitude: 120.1199932023883;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.267097738617565; longitude: 120.12069057673217;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.267435032619908; longitude: 120.12083005160095;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.267767692327087; longitude: 120.12096952646972;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.267965990453526; longitude: 120.12077104300262;"
                ></a-entity>
                <a-entity
                    look-at="[gps-camera]"
                    animation-mixer="loop: repeat"
                    gltf-model="#animated-asset"
                    scale="0.006269829102287733 0.006269829102287733 0.006269829102287733"
                    gps-entity-place="latitude: 30.268117030310187; longitude: 120.1204974576831;"
                ></a-entity>

            <a-camera gps-camera rotation-reader></a-camera>
        </a-scene>



    </body>
</html>
